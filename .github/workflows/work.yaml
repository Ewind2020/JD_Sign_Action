name: JD_Sign_Action

on:
  repository_dispatch:
  release:
    types: published
  # push:
  #   branches:
  #     - master
  schedule:
    - cron: 0 20 * * *
  watch:
    types: started
    
env:
  JD_COOKIE: ${{ cookie: shshshfpa=d1aae80f-19fe-01e2-10fa-d2d3f62d1d75-1548119082; shshshfpb=ljk3G55ZSMkwCxHOCvgT2bQ%3D%3D; whwswswws=; abtest=20190123171438245_37; pinId=-ZBbU4AmtORA9AXplivx1A; regionAddress=19%2C1666%2C36267%2C36274; commonAddress=138027761; __jdu=15481190755731444093801; pin=fshlj2017; unick=fshlj2017; _tp=PxZjxRP41OO%2BMxnyGG5aww%3D%3D; _pst=fshlj2017; ipLocation=%u5e7f%u4e1c; user-key=546c1886-11d4-44be-b0b8-5f75d5996a67; ceshi3.com=201; ipLoc-djd=19-1666-36267-36274.138027761; jcap_dvzw_fp=afa2a85a3cccb55ff3b12abafd2f3b92$848970575740; webp=1; mba_muid=15481190755731444093801; visitkey=49784878788102178; 3AB9D23F7A4B3C9B=FNJMQJKF5FF6XZCEZNBWRNLKCJTJHCO2NWB4NFVJFDF2POLXGVJAKKC7OEMPFTHSM2LLWTRJ2AOCB23CL2B6WJOYMU; TrackerID=7iCqUYPrB_TxenuxAsXwXAOBUdmXIFoVb0eEl5fCm-V5wCj_JyPwkLay00ah7govJ1GJPfs0sHRbifieGj3EISVoHA_JKlhNOW0wHsK-gB_EN5Lsrqfr7k2voI02Bqlc; pt_key=AAJfWcgsADDOF8USB_PySRBQJupAuaoinGXWlcrCUuaJx5WfYDM711V-IihMd-HwVJ-YnIBnLFY; pt_pin=fshlj2017; pt_token=pmhlv2dh; pwdt_id=fshlj2017; PPRD_P=UUID.15481190755731444093801; sc_width=1390; _fbp=fb.1.1599960525061.1352002952; wlfstk_smdl=rwqj5u6z87snahozvpunzmrw13fv7b1z; TrackID=1hUOxeMCa06S1OVhJoinzqN3MfNvK5s3B4S--I6kl4NPbuu1hi1LyXAbdki601VUpDnADOOwceaICNpxUV8K8nVz2N10LpZJf4QHOwPDr-dE; cn=21; __jdc=187205033; autoOpenApp_downCloseDate_auto=1600045916340_21600000; cid=3; retina=0; __jdv=187205033%7Ckong%7Ct_1001158479_%7Cjingfen%7Cb319711ccb824dc1bb642e60ca28ef91%7C1600221266574; RT="z=1&dm=jd.com&si=5tc938io60a&ss=kf4qfazf&sl=1&tt=0&obo=1&ld=3k7&r=a78153c1b63c3d8fd0b43f70f8229e90&ul=6aso&nu=9826bb7db96879f7ad04230a9096aec5&cl=4xnk&hd=6asr"; wxa_level=1; __wga=1600757883289.1600757883289.1600650857723.1599719659904.1.25; jxsid_s_t=1600757883360; jxsid_s_u=https%3A//coupon.m.jd.com/coupons/show.action; jxsid=16007578833639981163; shshshfp=ce4f37c19f831cf7fa6162adea702f51; mobilev=html5; __jda=187205033.15481190755731444093801.1548119075.1600757883.1600763467.674; __jdb=187205033.1.15481190755731444093801|674.1600763467; mba_sid=16007634674774808932239220398.1; __jd_ref_cls=Mnpm_ComponentApplied
 }}
  JD_DUAL_COOKIE: ${{ secrets.JD_DUAL_COOKIE }}
  PUSH_KEY: ${{ secrets.PUSH_KEY }}
  UPLOAD_BESULT_DIR: true

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout codes
              uses: actions/checkout@v2
              
            - name: Use Node.js
              uses: actions/setup-node@v1
              with:
                node-version: '12.x'
                
            - name: Run install
              run: npm install
              
            - name: Run Script
              run: node jd_sign.js
                
            - name: Upload result file
              uses: actions/upload-artifact@master
              if: env.UPLOAD_BESULT_DIR == 'true'
              with:
                name: result
                path: ./*.txt


